(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{204:function(e,t,r){"use strict";r.r(t);var n=r(13),o=r(183),c=r(194),l={components:{AddRecord:r(193).a},methods:{getMembers:function(){var e=this;o.a.call("post","ProjectGetUsers",{project_id:e.$attrs.project.id}).then(function(t){!1!==t.data.success&&(e.members=t.data)})},deleteItem:function(e){var t=this;o.a.call("post","ProjectRemoveMember",{user_id:e,project_id:t.$attrs.project.id}).then(function(e){e.data.message&&(t.message=e.data.message),t.getMembers()})},addMember:function(e){var t=this;e.preventDefault(),o.a.call("post","ProjectAddMember",{project_id:t.$attrs.project.id,user_id:t.form.user.id}).then(function(e){t.form.message=e.data.message,t.getMembers()})},getUsers:function(){var e=this;o.a.call("get","ListUsers",!1).then(function(t){e.users=t.data})}},data:function(){return{members:[],users:[],headers:[{text:"ID",align:"left",sortable:!0,value:"id"},{text:"Username",value:"username",align:"left"},{text:"Пользователь",value:"name",align:"left"},{text:"Действия",value:"actions"}],message:"",form:{message:null,user:{name:"",surname:"",username:""}}}},mounted:function(){this.getMembers(),this.getUsers()}},d=r(23),m=Object(d.a)(l,function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-layout",{attrs:{column:"","justify-center":"","align-center":""}},[r("v-flex",{attrs:{xs12:"",sm8:"",md6:""}},[r("v-card",[r("v-card-title",{staticClass:"headline"},[e._v("Участники проекта")]),e._v(" "),r("v-card-text",[r("p",[e._v(e._s(e.message))]),e._v(" "),r("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.members},scopedSlots:e._u([{key:"items",fn:function(t){return[r("td",[e._v(e._s(t.item.id))]),e._v(" "),r("td",[e._v(e._s(t.item.username))]),e._v(" "),r("td",[e._v(e._s(t.item.name)+" "+e._s(t.item.surname))]),e._v(" "),r("td",[r("v-icon",{attrs:{small:""},on:{click:function(r){return e.deleteItem(t.item.id)}}},[e._v("\n                  delete\n                ")])],1)]}}])})],1)],1),e._v(" "),e.users.length?r("v-card",[r("v-card-title",{staticClass:"headline"},[e._v("Добавить участника")]),e._v(" "),r("v-card-text",[r("p",[e._v(e._s(e.form.message))]),e._v(" "),r("v-form",{ref:"form",attrs:{"lazy-validation":""},on:{submit:e.addMember}},[r("v-select",{attrs:{items:e.users,hint:e.form.user.name+" "+e.form.user.surname+" "+e.form.user.username,"item-text":"username","item-value":"id",label:"Выберите пользователя","persistent-hint":"","return-object":"","single-line":""},model:{value:e.form.user,callback:function(t){e.$set(e.form,"user",t)},expression:"form.user"}}),e._v(" "),r("v-btn",{attrs:{type:"submit"}},[e._v("\n            Добавить\n          ")])],1)],1)],1):e._e()],1)],1)},[],!1,null,null,null).exports,v={components:{ShowRecords:c.a,ProjectMembers:m},methods:{getProject:function(){var e=this;o.a.getProject(this.$route.params.id).then(function(t){!1!==t.data.success&&(e.project=t.data,e.form=Object(n.a)({},t.data,{project_id:t.data.id}))}),o.a.getRecords({master_password:e.$store.state.masterPassword}).then(function(t){!1!==t.data.success&&(e.records=t.data)})},editProject:function(e){var t=this;e.preventDefault(),o.a.updateProject(this.form).then(function(e){e.data.success?(t.dialog=!1,t.getProject()):t.message=e.data.message})}},data:function(){return{dialog:!1,project:null,message:null,form:null,records:[],headers:[{text:"ID",align:"left",sortable:!0,value:"id"}]}},mounted:function(){this.getProject()}},f=Object(d.a)(v,function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-layout",{attrs:{column:"","justify-center":"","align-center":""}},[r("v-flex",{attrs:{xs12:"",sm8:"",md6:""}},[e.project?r("v-card",[r("v-card-title",{staticClass:"headline"},[e._v(e._s(e.project.name)+" \n                "),r("v-icon",{attrs:{small:""},on:{click:function(t){e.dialog=!0}}},[e._v("\n                  edit\n                ")])],1),e._v(" "),r("v-card-text",[r("pre",[e._v(e._s(e.project.description))])]),e._v(" "),r("ProjectMembers",{attrs:{project:e.project}}),e._v(" "),r("ShowRecords",{attrs:{project:e.project}})],1):e._e()],1),e._v(" "),e.project?r("v-dialog",{attrs:{persistent:"","max-width":"290"},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[r("v-card",[r("v-card-title",{staticClass:"headline"},[e._v("Изменение проекта")]),e._v(" "),r("v-card-text",[e._v("\n        "+e._s(e.message)+"\n        "),r("v-form",{ref:"form",attrs:{"lazy-validation":""},on:{submit:e.editProject}},[r("v-text-field",{attrs:{label:"Название",required:"",name:"name",value:"project.name"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}}),e._v(" "),r("v-textarea",{attrs:{solo:"",name:"description",label:"Описание",value:"project.description"},model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}}),e._v(" "),r("v-btn",{attrs:{type:"submit"}},[e._v("\n            Изменить\n          ")])],1)],1),e._v(" "),r("v-card-actions",[r("v-spacer"),e._v(" "),r("v-btn",{attrs:{color:"green darken-1",flat:""},on:{click:function(t){e.dialog=!1}}},[e._v("Закрыть")])],1)],1)],1):e._e()],1)},[],!1,null,null,null);t.default=f.exports}}]);